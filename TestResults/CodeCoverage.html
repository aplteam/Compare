<!DOCTYPE html>
<html lang="en">
<head>
<title>Coverage</title>
<meta charset="utf-8"/>
<style>
@media screen{
    html {background-color: #FFFFF0;}
body {
    font-size: 16px;
    font-family : Verdana, "Bitstream Vera Sans", "DejaVu Sans", Tahoma, Geneva, Arial, Sans-serif;
    margin: 1em;
}
th, td {padding: 5px 10px;}
th {text-align: left;}
h1, h2, h3, h4, h5, h6 {color: #424242;}
h1 {font-size: 22px;}
h2 {font-size: 18px; margin-top: 2em; margin-bottom:0.3em;}
tbody tr:nth-child(even) {background-color: #F0F0F0;}
tbody tr:nth-child(odd) {background-color: #FAFAFA;}
th {background-color: #E6E6E6;color: #424242;}
table {border: silver 1px solid; font-size: 14px;font-family: APLFont, monospace;}
code , code a {font-size: 14px; font-family: APLFont, monospace;}
code.header {
    font-size: 16px; 
    font-family: APLFont, monospace; 
    margin: 1.5em 0.5em 0 0.5em; 
    padding:0;
    display: block;
}
div.code-block {
    border: 1px silver dashed;
    background-color: #F2F2F2;
    display: block;
    margin: 0.5em 0.5em 0.5em 0.5em;
    padding: 0.5em;
}
div.code-block.missing {
    background-color: #fa605254;
}
div.code-block code {display: block; white-space: pre-wrap; margin:0; padding:0; word-wrap: break-word;}
.emphasize { font-weight: 800;}
ul li, ol li {margin: 0.7em 0.2em;}
.float-right {float:right;}
.no-underline {    text-decoration :none;}
.top-links {font-size:20px; padding-left: 0.6em;}
.align-right {text-align: right;}
#footer hr {margin-top:1.5em;}
#footer p {margin-top:5px; padding-top:0; font-size: 9px;}
@font-face {
        font-family: "APLFont";
    src:
        local("APL385 Unicode"),
        url("https://misc.aplteam.com/apl385.ttf") format("truetype");
}
.info {border: 1px silver dashed; background-color: #F2F2F2;margin: 0.5em; padding: 0.5em;}
}
@media print{@page {size: portrait}
@page {
    margin: 1cm 1cm 1cm 1.75cm;
    @bottom-right {
        content: counter(page) " / " counter(pages);
  }
}
body {
    font: 12pt "Times New Roman", Times, serif;
    line-height: 1.2;
     /* CSS3 filter, at the moment Webkit only. Prefix it for future implementations */
    -webkit-filter: grayscale(100%);
    filter: grayscale(100%); /* future-proof */
}
h1 {font-size: 18pt;}
h2 {font-size: 16pt; margin-top: 10pt; margin-bottom: 3pt;}
th, td {padding: 2pt 3pt;}
th {text-align: left;background-color: #DBDBDB;}
tbody tr:nth-child(odd) {background-color: #EDEDED;}
table {
    color-adjust: exact !important;
    -webkit-print-color-adjust: exact !important;
    print-color-adjust: exact !important;
    font-size: 8pt;
    font-family: APLFont, monospace;
}
div.keep-together {break-inside: avoid; break-before:auto;}
table {border: silver 1pt solid;}
code , code a {font-size: 8pt; font-family: APLFont, monospace;}
code.header {
    font-size: 8pt;
    font-family: APLFont, monospace;
    margin: 7pt 3pt 0 10pt;
    padding:0;
    display: block;
}
div.code-block {
    border: 1pt silver dashed;
    background-color: #F2F2F2;
    display: block;
    margin: 4pt 4pt 4pt 4pt;
    padding: 4pt;
}
div.code-block code {display: block; white-space: pre-wrap; margin:0; padding:0; word-wrap: break-word;}
.emphasize { font-weight: 800;}
a {text-decoration: none;color: black;}
ul li, ol li {margin: 8pt 3pt;}
.no-print {display:none;}
.align-right {text-align: right;}
#footer hr {margin-top:1.5em;}
#footer p {margin-top:5pt; padding-top:0; font-size: 6pt;}
@font-face {
        font-family: "APLFont";
    src:
        local("APL385 Unicode"),
        url("https://misc.aplteam.com/apl385.ttf") format("truetype");
}
.info {border: 1px silver dashed; background-color: #F2F2F2;margin: 8px; padding: 8px;}
}
</style>
<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/jq-3.6.0/dt-1.11.2/b-2.0.0/b-print-2.0.0/fh-3.1.9/r-2.2.9/datatables.min.css"/>
<script type="text/javascript" src="https://cdn.datatables.net/v/dt/jq-3.6.0/dt-1.11.2/b-2.0.0/b-print-2.0.0/fh-3.1.9/r-2.2.9/datatables.min.js"></script>
</head>
<body>
<h1 id="top">Coverage Report</h1>
<p>Watched: 34 fns/opr within <code>#.Compare.Compare</code></p>
<p>The test suite was executed once:</p>
<table>
<thead>
<tr><th>Executed at</th><th>APLVersion</th><th>Memory (MB)</th></tr>
</thead>
<tbody>
<tr><td>2025-03-28 19:30:04</td><td>Windows-64 ⋄ 19.0.50771.0 ⋄ W ⋄ Development ⋄ Unicode</td><td>109</td></tr>
</tbody>
</table>
<p>Overall 63% of the testable code is covered.</p>
<p>(Comment lines, empty lines, all <code>:End</code>* lines etc. are ignored)</p>
<p>21 of the fns/opr are 100% covered.</p>
<div id="partly-covered" class="keep-together">
<table id="percent">
<thead>
<tr><th style="text-align:left;">Function/Operator</th><th style="text-align:left;">Lines not executed</th><th style="text-align:left;">Coverage</th><th style="text-align:right;">≢</th></tr>
</thead>
<tbody>
<tr class="uncovered"><td><a href="#listing_1" title="Link to listing">#.Compare.Compare.Version</a></td><td>5←≢3-6,10</td><td>0</td><td>5</td></tr>
<tr class="uncovered"><td><a href="#listing_2" title="Link to listing">#.Compare.Compare.DisplayDiff</a></td><td>4←≢5-8</td><td>0</td><td>4</td></tr>
<tr class="uncovered"><td><a href="#listing_3" title="Link to listing">#.Compare.Compare.Run</a></td><td>8←≢3-9,11</td><td>0</td><td>8</td></tr>
<tr class="uncovered"><td><a href="#listing_4" title="Link to listing">#.Compare.Compare.YesOrNo</a></td><td>8←≢1-8</td><td>0</td><td>8</td></tr>
<tr class="uncovered"><td><a href="#listing_5" title="Link to listing">#.Compare.Compare.ShowMsg</a></td><td>9←≢1-9</td><td>0</td><td>9</td></tr>
<tr class="uncovered"><td><a href="#listing_6" title="Link to listing">#.Compare.Compare.OnContextMenu</a></td><td>52←≢1-11,13-18,20-30,32-52,54-55,57</td><td>0</td><td>52</td></tr>
<tr class="uncovered"><td><a href="#listing_7" title="Link to listing">#.Compare.Compare.OnCompare</a></td><td>13←≢1-13</td><td>0</td><td>13</td></tr>
<tr><td><a href="#listing_8" title="Link to listing">#.Compare.Compare.RemoveRefsToTatin</a></td><td>4</td><td>75</td><td>4</td></tr>
<tr><td><a href="#listing_9" title="Link to listing">#.Compare.Compare.ScanOrdinaryNamespacesInBothRefs</a></td><td>4←≢7-8,12-13</td><td>83</td><td>24</td></tr>
<tr><td><a href="#listing_10" title="Link to listing">#.Compare.Compare.Merge</a></td><td>5←≢26,51,56-57,59</td><td>84</td><td>31</td></tr>
<tr><td><a href="#listing_11" title="Link to listing">#.Compare.Compare.InvestigateInstances</a></td><td>9, 18, 26</td><td>87</td><td>23</td></tr>
<tr><td><a href="#listing_12" title="Link to listing">#.Compare.Compare.ScanCodeFoundInBothRefs</a></td><td>16</td><td>93</td><td>15</td></tr>
<tr><td><a href="#listing_13" title="Link to listing">#.Compare.Compare.ns_</a></td><td>17</td><td>97</td><td>31</td></tr>
<tr class="fullyCovered"><td><a href="#listing_14" title="Link to listing">#.Compare.Compare.set_refToContainer1</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_15" title="Link to listing">#.Compare.Compare.get_refToContainer1</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_16" title="Link to listing">#.Compare.Compare.set_refToContainer2</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_17" title="Link to listing">#.Compare.Compare.get_refToContainer2</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_18" title="Link to listing">#.Compare.Compare.set_default data</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_19" title="Link to listing">#.Compare.Compare.get_default data</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_20" title="Link to listing">#.Compare.Compare.History</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_21" title="Link to listing">#.Compare.Compare.CreateMergeParms</a></td><td></td><td>100</td><td>5</td></tr>
<tr class="fullyCovered"><td><a href="#listing_22" title="Link to listing">#.Compare.Compare.FormatTS</a></td><td></td><td>100</td><td>4</td></tr>
<tr class="fullyCovered"><td><a href="#listing_23" title="Link to listing">#.Compare.Compare.ProcessUniqueObjects</a></td><td></td><td>100</td><td>10</td></tr>
<tr class="fullyCovered"><td><a href="#listing_24" title="Link to listing">#.Compare.Compare.ProcessCode</a></td><td></td><td>100</td><td>14</td></tr>
<tr class="fullyCovered"><td><a href="#listing_25" title="Link to listing">#.Compare.Compare.Differ</a></td><td></td><td>100</td><td>13</td></tr>
<tr class="fullyCovered"><td><a href="#listing_26" title="Link to listing">#.Compare.Compare.ReportRubbishIn</a></td><td></td><td>100</td><td>7</td></tr>
<tr class="fullyCovered"><td><a href="#listing_27" title="Link to listing">#.Compare.Compare.InvestigateNamespaces</a></td><td></td><td>100</td><td>12</td></tr>
<tr class="fullyCovered"><td><a href="#listing_28" title="Link to listing">#.Compare.Compare.InvestigateClassesAndInterfaces</a></td><td></td><td>100</td><td>6</td></tr>
<tr class="fullyCovered"><td><a href="#listing_29" title="Link to listing">#.Compare.Compare.PolishRubbishReport</a></td><td></td><td>100</td><td>12</td></tr>
<tr class="fullyCovered"><td><a href="#listing_30" title="Link to listing">#.Compare.Compare.n</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_31" title="Link to listing">#.Compare.Compare.r</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_32" title="Link to listing">#.Compare.Compare.wait</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_33" title="Link to listing">#.Compare.Compare.caption</a></td><td></td><td>100</td><td>0</td></tr>
<tr class="fullyCovered"><td><a href="#listing_34" title="Link to listing">#.Compare.Compare.recursionFlag</a></td><td></td><td>100</td><td>0</td></tr>
</tbody>
</table>
</div>
<script>
$(document).ready(function() {
    var oTable;
    oTable = $("#percent").DataTable( {
        paging:   false,
        ordering: true,
        info:     true,
        fixedHeader: true,
        order: [2,"asc"],
        dom: "Bft",
        drawCallback: function( settings ) {
             var api = this.api();
             $('.header[id^="listing_"]').next().addBack().css("display","none");
             api.rows( {page:"current"} ).data().each(function(data){
              id = data[0];
              id = id.match(/"(\#.*?)"/);
              if (id){$(id[1]).next().addBack().css("display","block");}
             })
        },      
        buttons: [
        {
            text: "Partly covered (6)",
            titleAttr: "50%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "^(?!(0%|100%)).*";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "Uncovered (7)",
            titleAttr: "0%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "^0%";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "Fully covered (21)",
            titleAttr: "100%",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = "100%";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
        {
            text: "All (34)",
            titleAttr: "all",
            className: "active",
            action: function ( e, dt, node, config ) {
                var text = this.text();
                var search = ".";
                oTable.column(2)
                    .search(search,true,false,false)
                    .draw();
                $(".dt-buttons button").removeClass("active");
                this.active( true );
            }
        },
    ],
 
        columnDefs: [
            {className: "align-right", targets: [2,3]
            },
            {
                render: function ( data, type, row, meta ) {
                            return data+"%" ;        
                        },
                targets: 2
            }
        ]             
    } );
    oTable.button(0).trigger();

} );    
</script>
<h2>Listings</h2>
<code class="header" id="listing_1">#.Compare.Compare.Version &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←Version</code>
<code> [1]      ⍝ Returns the version number from `TatinVars` if possible.</code>
<code> [2]      ⍝ See also `History`</code>
<code class="emphasize">→[3]   :If 0&lt;⎕NC'TatinVars.CONFIG'</code>
<code class="emphasize">→[4]       r←(⎕JSON⍠('Dialect' 'JSON5')⊢TatinVars.CONFIG).version</code>
<code class="emphasize">→[5]   :ElseIf 0&lt;##.⎕NC'TatinVars.CONFIG'</code>
<code class="emphasize">→[6]       r←(⎕JSON⍠('Dialect' 'JSON5')⊢##.TatinVars.CONFIG).version</code>
<code> [7]   :Else</code>
<code> [8]      ⍝ When a script was not loaded with Tatin, there will be no namespace `TatinVars`.</code>
<code> [9]      ⍝ In such cases we cannot provide a version number, so we return just ''.</code>
<code class="emphasize">→[10]      r←''</code>
<code> [11]  :EndIf</code>
</div>
<code class="header" id="listing_2">#.Compare.Compare.DisplayDiff &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> {r}←{n}DisplayDiff(diff readOnly versionNo data)</code>
<code> [1]     ⍝ Designed to display the result of `Merge`.</code>
<code> [2]     ⍝ `readOnly` supresses everything that enables a user to change anything.</code>
<code> [3]     ⍝ `n` is optional. When passed it must be the container with all refs of the GUI from which DisplayDiff got started.</code>
<code> [4]     ⍝ See ]CompareGUI for this</code>
<code class="emphasize">→[5]  (⎕IO ⎕ML)←1 3</code>
<code class="emphasize">→[6]  r←⍬</code>
<code class="emphasize">→[7]  n←{0&lt;⎕NC ⍵:⍎⍵ ⋄ ⍬}'n'</code>
<code class="emphasize">→[8]  n Display.Diff diff readOnly versionNo data</code>
</div>
<code class="header" id="listing_3">#.Compare.Compare.Run &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {R}←{wait}Run cmd</code>
<code> [1]          ⍝ Starts an application</code>
<code> [2]          ⍝ By default, Run waits for the app to quit.</code>
<code class="emphasize">→[3]   R←0 ''</code>
<code class="emphasize">→[4]   wait←{0&lt;⎕NC ⍵:⍎⍵ ⋄ 1}'wait'</code>
<code class="emphasize">→[5]   'Invalid left argument: must be a Boolean'⎕SIGNAL 11/⍨~wait∊0 1</code>
<code class="emphasize">→[6]   windowStyle←8 ⍝ is WINDOWSTYLE.NORMAL</code>
<code class="emphasize">→[7]   'wsh'⎕WC'OLEClient' 'WScript.Shell'</code>
<code class="emphasize">→[8]   :Trap 0</code>
<code class="emphasize">→[9]       {}wsh.Run cmd windowStyle wait</code>
<code> [10]  :Else</code>
<code class="emphasize">→[11]      R←1('.'⎕WG'LastError')</code>
<code> [12]  :EndTrap</code>
</div>
<code class="header" id="listing_4">#.Compare.Compare.YesOrNo &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> flag←{caption}YesOrNo question</code>
<code class="emphasize">→[1]  caption←{0&lt;⎕NC ⍵:'Compare: ',⍎⍵ ⋄ 'Compare'}'caption'</code>
<code class="emphasize">→[2]  ∆←⊂'MsgBox'</code>
<code class="emphasize">→[3]  ∆,←⊂caption</code>
<code class="emphasize">→[4]  ∆,←⊂'Text'question</code>
<code class="emphasize">→[5]  ∆,←⊂'Style' 'Query'</code>
<code class="emphasize">→[6]  ∆,←⊂'Event'('MsgBtn1' 'MsgBtn2')1</code>
<code class="emphasize">→[7]  'ms'⎕WC ∆</code>
<code class="emphasize">→[8]  flag←'MsgBtn1'≡2⊃⎕DQ'ms'</code>
</div>
<code class="header" id="listing_5">#.Compare.Compare.ShowMsg &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←{caption}ShowMsg question</code>
<code class="emphasize">→[1]   r←⍬</code>
<code class="emphasize">→[2]   caption←{0&lt;⎕NC ⍵:'Compare: ',⍎⍵ ⋄ 'Compare'}'caption'</code>
<code class="emphasize">→[3]   ∆←⊂'MsgBox'</code>
<code class="emphasize">→[4]   ∆,←⊂caption</code>
<code class="emphasize">→[5]   ∆,←⊂'Text'question</code>
<code class="emphasize">→[6]   ∆,←⊂'Style' 'Info'</code>
<code class="emphasize">→[7]   ∆,←⊂'Event'('MsgBtn1')1</code>
<code class="emphasize">→[8]   'ms'⎕WC ∆</code>
<code class="emphasize">→[9]   {}⎕DQ'ms'</code>
</div>
<code class="header" id="listing_6">#.Compare.Compare.OnContextMenu &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←OnContextMenu msg</code>
<code class="emphasize">→[1]   r←0</code>
<code class="emphasize">→[2]   m←⎕NEW⊂'Menu'</code>
<code class="emphasize">→[3]   m.(i1←⎕NEW'MenuItem'(⊂'Caption' 'Compare selected'))</code>
<code class="emphasize">→[4]   m.i1.onSelect←1</code>
<code class="emphasize">→[5]   m.i1.no←1</code>
<code class="emphasize">→[6]   m.(i2←⎕NEW'MenuItem'(⊂'Caption' 'Compare with workspace'))</code>
<code class="emphasize">→[7]   m.i2.onSelect←1</code>
<code class="emphasize">→[8]   m.i2.no←2</code>
<code class="emphasize">→[9]   m.(i4←⎕NEW'MenuItem'(⊂'Caption' 'Edit workspace version'))</code>
<code class="emphasize">→[10]  m.i4.onSelect←1</code>
<code class="emphasize">→[11]  m.i4.no←4</code>
<code> [12] </code>
<code class="emphasize">→[13]  :If 0≠≢res←m.Wait</code>
<code class="emphasize">→[14]      :Select ↑{⍵.no}1⊃res</code>
<code class="emphasize">→[15]      :Case 1</code>
<code class="emphasize">→[16]          :If 0∊+/¨f.sfTop.(right left).SelItems</code>
<code class="emphasize">→[17]              mm←⎕NEW'MsgBox'(('Caption' 'Compare')('Text' 'Please select one item on each side'))</code>
<code class="emphasize">→[18]              mm.Wait</code>
<code> [19]          :Else</code>
<code class="emphasize">→[20]              no1←f.sfTop.left.SelItems⍳1</code>
<code class="emphasize">→[21]              no2←f.sfTop.right.SelItems⍳1</code>
<code class="emphasize">→[22]              body1←4⊃no1⊃versions</code>
<code class="emphasize">→[23]              title1←{'Version ',(⍕1⊃⍵),' from ',(2⊃⍵),' ',(3⊃⍵),' by ',4⊃⍵}meta[no1;]</code>
<code class="emphasize">→[24]              body2←4⊃no2⊃versions</code>
<code class="emphasize">→[25]              title2←{'Version ',(⍕1⊃⍵),' from ',(2⊃⍵),' ',(3⊃⍵),' by ',4⊃⍵}meta[no2;]</code>
<code class="emphasize">→[26]              filename1←F.GetTempPath,(' '~⍨⍕⎕TS),(⍕?1000),'_',⎕AN,'.txt'</code>
<code class="emphasize">→[27]              (⊂body)F.NPUT filename1 1</code>
<code class="emphasize">→[28]              filename2←F.GetTempPath,(' '~⍨⍕⎕TS),(⍕?1000),'_',⎕AN,'.txt'</code>
<code class="emphasize">→[29]              (⊂body)F.NPUT filename2 1</code>
<code class="emphasize">→[30]              RunCompareIt filename1 filename2 1 title1 title2</code>
<code> [31]          :EndIf</code>
<code class="emphasize">→[32]      :Case 2</code>
<code class="emphasize">→[33]          wanted←(⍎' f.sfTop.',({⍵.name}1⊃msg),'.SelItems')⍳1</code>
<code class="emphasize">→[34]          wanted←⍎wanted⊃⍎' f.sfTop.',({⍵.name}1⊃msg),'.Items'</code>
<code class="emphasize">→[35]          no1←meta[;1]⍳wanted</code>
<code class="emphasize">→[36]          body1←4⊃no1⊃versions</code>
<code class="emphasize">→[37]          title1←{'Version ',(⍕1⊃⍵),' from ',(2⊃⍵),' ',(3⊃⍵),' by ',4⊃⍵}meta[no1;]</code>
<code class="emphasize">→[38]          filename1←F.GetTempPath,(' '~⍨⍕⎕TS),(⍕?1000),'_',⎕AN,'.txt'</code>
<code class="emphasize">→[39]          (⊂body)F.NPUT filename1 1</code>
<code class="emphasize">→[40]          cs←CreateParmsFor_These</code>
<code class="emphasize">→[41]          cs.alias1←title1</code>
<code class="emphasize">→[42]          cs.alias2←name</code>
<code class="emphasize">→[43]          cs These name filename1</code>
<code class="emphasize">→[44]      :Case 3</code>
<code class="emphasize">→[45]          . ⍝ This code is experimental and not ready anyway!!</code>
<code class="emphasize">→[46]          no←(⍎' f.sfTop.',({⍵.name}1⊃msg),'.SelItems')⍳1</code>
<code class="emphasize">→[47]          wanted←⍎no⊃⍎' f.sfTop.',({⍵.name}1⊃msg),'.Items'</code>
<code class="emphasize">→[48]          no←({⍎⍵↑⍨¯1+⍵⍳' '}¨{⍵↓⍨+/∧\' '=⍵}¨versions)⍳wanted</code>
<code class="emphasize">→[49]          (body title)←(⎕UCS 13){⌽¨⍺ ##.APLTreeUtils2.SplitPath⌽⍵}no⊃versions</code>
<code class="emphasize">→[50]          question←'Copy ',title,' to workspace?'</code>
<code class="emphasize">→[51]          :If 'Get version into workspace'YesOrNo question</code>
<code class="emphasize">→[52]              .</code>
<code> [53]          :EndIf</code>
<code class="emphasize">→[54]      :Case 4</code>
<code class="emphasize">→[55]          ⎕ED name</code>
<code> [56]      :Else</code>
<code class="emphasize">→[57]          . ⍝ Huuh?!</code>
<code> [58]      :EndSelect</code>
<code> [59]  :EndIf</code>
</div>
<code class="header" id="listing_7">#.Compare.Compare.OnCompare &mdash; 0%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←OnCompare msg</code>
<code class="emphasize">→[1]   r←0</code>
<code class="emphasize">→[2]   →(0=+/bool←f.table.Values[;4])/0  ⍝ no radio is on, so what we are supposed to do?!</code>
<code class="emphasize">→[3]   no1←bool⍳1                    ⍝ which row?</code>
<code class="emphasize">→[4]   no2←1⊃f.table.CurCell         ⍝ in which row was "Compare" pressed?</code>
<code class="emphasize">→[5]   body1←4⊃no1⊃versions</code>
<code class="emphasize">→[6]   title1←{'Version ',(⍕1⊃⍵),' from ',(2⊃⍵),' ',(3⊃⍵),' by ',4⊃⍵}meta[no1;]</code>
<code class="emphasize">→[7]   body2←4⊃no2⊃versions</code>
<code class="emphasize">→[8]   title2←{'Version ',(⍕1⊃⍵),' from ',(2⊃⍵),' ',(3⊃⍵),' by ',4⊃⍵}meta[no2;]</code>
<code class="emphasize">→[9]   filename1←F.GetTempPath,(' '~⍨⍕⎕TS),(⍕?1000),'_',⎕AN,'.txt'</code>
<code class="emphasize">→[10]  (⊂body1)F.NPUT filename1 1</code>
<code class="emphasize">→[11]  filename2←F.GetTempPath,(' '~⍨⍕⎕TS),(⍕?1000),'_',⎕AN,'.txt'</code>
<code class="emphasize">→[12]  (⊂body)F.NPUT filename2 1</code>
<code class="emphasize">→[13]  RunCompareIt filename1 filename2 1 title1 title2</code>
</div>
<code class="header" id="listing_8">#.Compare.Compare.RemoveRefsToTatin &mdash; 75%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> list←RemoveRefsToTatin(ref list)</code>
<code> [1]  :If 0&lt;≢list</code>
<code> [2]  :AndIf ∨/bool←9.1=↑∘ref.⎕NC¨⊂¨list</code>
<code> [3]  :AndIf ∨/~bool2←~∨/¨((⍕ref),'._tatin.')∘⍷¨⍕¨ref{⍺⍎⍵}¨bool/list</code>
<code class="emphasize">→[4]      list←(bool\bool2)/list</code>
<code> [5]  :EndIf</code>
</div>
<code class="header" id="listing_9">#.Compare.Compare.ScanOrdinaryNamespacesInBothRefs &mdash; 83%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←ScanOrdinaryNamespacesInBothRefs(ref1 ref2 data parms)</code>
<code> [1]      ⍝ Loop over all ordinary (non-scripted) namespaces that exist in both, [1] and [2]</code>
<code> [2]   r←⍬</code>
<code> [3]   (list1 list2)←ListOrdinaryNamespaces¨ref1 ref2</code>
<code> [4]   :If parms.ignoreTatin</code>
<code> [5]       :If 0&lt;≢list1</code>
<code> [6]       :AndIf 0&lt;ref1.⎕NC'_tatin'</code>
<code class="emphasize">→[7]       :AndIf 0&lt;≢list1←list1~⊂⍎(⍕ref1),'._tatin'</code>
<code class="emphasize">→[8]           list1/⍨←((⍕ref1),'._tatin'){(⍺,'.')∘≢¨'.',⍨¨(≢⍺)↑¨⍕¨⍵}list1</code>
<code> [9]       :EndIf</code>
<code> [10]      :If 0&lt;≢list2</code>
<code> [11]      :AndIf 0&lt;ref2.⎕NC'_tatin'</code>
<code class="emphasize">→[12]      :AndIf 0&lt;≢list2←list2~⊂⍎(⍕ref2),'._tatin'</code>
<code class="emphasize">→[13]          list2/⍨←((⍕ref2),'._tatin'){(⍺,'.')∘≢¨'.',⍨¨(≢⍺)↑¨⍕¨⍵}list2</code>
<code> [14]      :EndIf</code>
<code> [15]  :EndIf</code>
<code> [16]  list1~←data.objects1</code>
<code> [17]  list2~←data.objects2</code>
<code> [18]  :If 0≠≢≢¨list1 list2</code>
<code> [19]  :AndIf 0∧.&lt;≢¨⍕¨ref1 ref2 ⍝ both must be alive for that</code>
<code> [20]      lista←((1+⍴⍕ref2)↓¨⍕¨list2){⍺/⍨⍺∊⍵}((1+⍴⍕ref1)↓¨⍕¨list1)</code>
<code> [21]      listb←((1+⍴⍕ref1)↓¨⍕¨list1){⍺/⍨⍺∊⍵}((1+⍴⍕ref2)↓¨⍕¨list2)</code>
<code> [22]      list←lista∩listb</code>
<code> [23]  :AndIf 0≠≢list←lista∩listb</code>
<code> [24]      :For this :In list</code>
<code> [25]          :If 9.1=⎕NC⊂(⍕ref2),'.',this</code>
<code> [26]          :AndIf {11 16::1 ⋄ 0⊣⎕SRC ⍵}⍎(⍕ref2),'.',this        ⍝ pass if it is an ordinary namespace</code>
<code> [27]          :AndIf ref1 ref2≢{6::⍬ ⋄ ⍎⍵}¨this∘{(⍕⍵),'.',⍺}¨ref1 ref2</code>
<code> [28]              1 ns_({6::⍬ ⋄ ⍎⍵}¨this∘{(⍕⍵),'.',⍺}¨ref1 ref2),data parms</code>
<code> [29]          :EndIf</code>
<code> [30]      :EndFor</code>
<code> [31]  :EndIf</code>
</div>
<code class="header" id="listing_10">#.Compare.Compare.Merge &mdash; 84%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←{parms}Merge(ref1 ref2)</code>
<code> [1]   :Access Public Shared</code>
<code> [2]      ⍝ Useful to compare namespaces with each other.\\</code>
<code> [3]      ⍝ The right argument must be references to the namespaces to be compared.\\</code>
<code> [4]      ⍝ `parms` is optional and defaults to what is returned by `CreateMergeParms:</code>
<code> [5]      ⍝ * `readOnly` controls the user's ability to change the code.</code>
<code> [6]      ⍝   Might be a scalar or a vector of length two, one Boolean for each pane.</code>
<code> [7]      ⍝   Defaults to 0, meaning the user can change everything.</code>
<code> [8]      ⍝ * `refsAreRubbish`: 1 means that unnamed namespaces (which by definition</code>
<code> [9]      ⍝   are always represented by refs) are considered to be temporary and</code>
<code> [10]     ⍝   therefore they need to be reported as "rubbish". This is a highly</code>
<code> [11]     ⍝   philosphical thing to decide, so we leave this to the user. Default is 1.</code>
<code> [12]     ⍝ * `ignoreTatin`: Tatin packages are loaded into #._tatin or ⎕SE._tatin.</code>
<code> [13]     ⍝   If this is 1 (the default) then these two namespace are ignored,</code>
<code> [14]     ⍝   Note however, that refs pointing into those two namespaces would still</code>
<code> [15]     ⍝   show unless `refsAreRubbish` is 1.\\</code>
<code> [16]     ⍝ The `readOnly` can be:</code>
<code> [17]     ⍝ |`0`  | Allow user changes</code>
<code> [18]     ⍝ |`1`  | Don't allow changes</code>
<code> [19]     ⍝ |`¯1` | Don't show anything, just return data structures</code>
<code> [20]     ⍝ |`¯2` | Deprecated and ignored</code>
<code> [21]     ⍝ Result:\\</code>
<code> [22]     ⍝ Always a two-item vector with the differences reported in [1] and any</code>
<code> [23]     ⍝ rubbish reported in [2].</code>
<code> [24]  (⎕ML ⎕IO)←3 1</code>
<code> [25]  :If 0=⎕NC'parms'</code>
<code class="emphasize">→[26]      parms←CreateMergeParms</code>
<code> [27]  :EndIf</code>
<code> [28]  :If ∧/parms∊0 1 ¯2 ¯1  ⍝ Legacy: in old versions the left argument was just readOnly</code>
<code> [29]      buff←parms</code>
<code> [30]      parms←CreateMergeParms</code>
<code> [31]      parms.readOnly←buff</code>
<code> [32]  :EndIf</code>
<code> [33]  parms.readOnly←{(1=⍴,⍵):2⍴⍵ ⋄ (2=⍴⍵):⍵ ⋄ 'Invalid: "readOnly'⎕SIGNAL 11}parms.readOnly</code>
<code> [34]  'Invalid: "refsAreRubbish'⎕SIGNAL 11/⍨{∧/(,¨⍵)≢¨,¨1 0}parms.refsAreRubbish</code>
<code> [35]  'Invalid left argument: must be one of ¯1, ¯2, 0, 1'⎕SIGNAL 11/⍨∨/~parms.readOnly∊¯1 0 1 ¯2</code>
<code> [36]  'ref1 is not pointing to a namespace'⎕SIGNAL 11/⍨~{0::0 ⋄ 'Namespace'≡⍵.⎕WG'Type'}ref1</code>
<code> [37]  'ref2 is not pointing to a namespace'⎕SIGNAL 11/⍨~{0::0 ⋄ 'Namespace'≡⍵.⎕WG'Type'}ref2</code>
<code> [38]  (ref1 ref2).⎕DF ⎕NULL</code>
<code> [39]  (ref1 ref2)←{(0=≢⍵):⍵ ⋄ ⍎⍕⍵}¨ref1 ref2</code>
<code> [40]  'ref1 is not a reference to a namespace'⎕SIGNAL 11/⍨0=IsNotScript ref1</code>
<code> [41]  'ref2 is not a reference to a namespace'⎕SIGNAL 11/⍨0=IsNotScript ref2</code>
<code> [42]  data←⎕NS''</code>
<code> [43]  data.(report←report1←report2←rubbish1←rubbish2←objects1←objects2←⍬)</code>
<code> [44]  ns_ ref1 ref2 data parms</code>
<code> [45]  rubbishReport←PolishRubbishReport ref1 ref2 data parms</code>
<code> [46]  :If 0=≢data.report←⊃data.report</code>
<code> [47]      r←''rubbishReport</code>
<code> [48]  :Else</code>
<code> [49]      obj←⎕NEW CompareData(ref1 ref2 data.report)</code>
<code> [50]      :If 0&lt;parms.⎕NC'n'</code>
<code class="emphasize">→[51]          parms.n.parms←parms</code>
<code> [52]      :Else</code>
<code> [53]          parms.n←⍬</code>
<code> [54]      :EndIf</code>
<code> [55]      :If ∧/parms.readOnly∊0 1 ¯2</code>
<code class="emphasize">→[56]          :If 0=parms.⎕NC'n'</code>
<code class="emphasize">→[57]              reftoGui←DisplayDiff obj parms.readOnly(2⊃Version)rubbishReport</code>
<code> [58]          :Else</code>
<code class="emphasize">→[59]              reftoGui←parms.n DisplayDiff obj parms.readOnly(2⊃Version)rubbishReport</code>
<code> [60]          :EndIf</code>
<code> [61]      :EndIf</code>
<code> [62]      r←data.report rubbishReport</code>
<code> [63]  :EndIf</code>
</div>
<code class="header" id="listing_11">#.Compare.Compare.InvestigateInstances &mdash; 87%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (report rubbishObjects)←InvestigateInstances(ref rubbishObjects report)</code>
<code> [1]      ⍝ Finally we deal with instances of all sorts.</code>
<code> [2]   :If 0≠≢list←ref.⎕NL-9.2                  ⍝ Any instances at all?</code>
<code> [3]       fn←(⊂(⍕ref),'.'),¨list                ⍝ Fully qualified names</code>
<code> [4]       bool←{0::0 ⋄ ⍵ ⎕WG'KeepOnClose'}¨fn</code>
<code> [5]       :If 1∊bool</code>
<code> [6]           report,←⊂'GUI Instances with KeepOnClose=1:'(bool/fn)</code>
<code> [7]           rubbishObjects,←bool/fn</code>
<code> [8]           :If 0=≢fn←(~bool)/fn</code>
<code class="emphasize">→[9]               :Return</code>
<code> [10]          :EndIf</code>
<code> [11]      :EndIf</code>
<code> [12]       ⍝ Instances may have code in their attached namespaces:</code>
<code> [13]      :If 1∊bool←{0≠≢⍵.⎕NL⍳16}¨⍎¨fn</code>
<code> [14]          msg←'Instances with code in attached namespace:'</code>
<code> [15]          report,←⊂(msg)(bool/fn) ⍝ Indeed!</code>
<code> [16]          rubbishObjects,←bool/fn</code>
<code> [17]          :If 0=≢fn←(~bool)/fn</code>
<code class="emphasize">→[18]              :Return</code>
<code> [19]          :EndIf</code>
<code> [20]      :EndIf</code>
<code> [21]      types←{⍵ ⎕WG'Type'}¨fn</code>
<code> [22]      :If 1∊bool←'Instance'∘≡¨types</code>
<code> [23]          report,←⊂'Class Instances:'(bool/fn)</code>
<code> [24]          rubbishObjects,←bool/fn</code>
<code> [25]          :If 0=+/bool</code>
<code class="emphasize">→[26]              :Return</code>
<code> [27]          :EndIf</code>
<code> [28]      :EndIf</code>
<code> [29]      :If 0∊bool</code>
<code> [30]          report,←⊂'Other Instances:'((~bool)/fn)</code>
<code> [31]          rubbishObjects,←(~bool)/fn</code>
<code> [32]      :EndIf</code>
<code> [33]  :EndIf</code>
</div>
<code class="header" id="listing_12">#.Compare.Compare.ScanCodeFoundInBothRefs &mdash; 93%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←ScanCodeFoundInBothRefs(list ref1 ref2)</code>
<code> [1]      ⍝ Any stuff that is code (fns, opr, script) and exists in both, [1] and [2]</code>
<code> [2]   r←''</code>
<code> [3]   :For this :In list</code>
<code> [4]       ⍝⍎(this≡'Server')/'.'</code>
<code> [5]       body1←Display.GetBody name1←(⍕ref1),'.',this</code>
<code> [6]       body2←Display.GetBody name2←(⍕ref2),'.',this</code>
<code> [7]       buffer←'=≠'[1+body1 Differ body2]</code>
<code> [8]       buffer,←⊂{⍵↑⍨1+-'.'⍳⍨⌽⍵}name1</code>
<code> [9]       buffer,←⊂{⍵↓⍨-'.'⍳⍨⌽⍵}name1</code>
<code> [10]      buffer,←⊂{⍵↓⍨-'.'⍳⍨⌽⍵}name2</code>
<code> [11]      buffer,←⊂ref1.⎕NC⊂this</code>
<code> [12]      buffer,←⊂ref2.⎕NC⊂this</code>
<code> [13]      buffer←buffer,FormatTS¨↓2 ⎕AT name1 name2</code>
<code> [14]      buffer←buffer,{⍵[;4]}⎕AT name1 name2</code>
<code> [15]      :If ≠/buffer[5 6] ⍝ Even the type differs!!</code>
<code class="emphasize">→[16]          buffer[1]←'≢'</code>
<code> [17]      :EndIf</code>
<code> [18]      r,←⊂buffer</code>
<code> [19]  :EndFor</code>
</div>
<code class="header" id="listing_13">#.Compare.Compare.ns_ &mdash; 97%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←{recursionFlag}ns_(ref1 ref2 data parms)</code>
<code> [1]      ⍝ Doing the hard work of the comparison of namespaces:</code>
<code> [2]      ⍝ 1. compare fns</code>
<code> [3]      ⍝ 2. compare opr</code>
<code> [4]      ⍝ 3. compare classes and interfaces</code>
<code> [5]      ⍝ 4. compare scripted namespaces</code>
<code> [6]      ⍝ 5. Call recursively if there are non-scripted sub-namespaces\\</code>
<code> [7]      ⍝ Adds rows to semi-global "report" (the "result" of the investigation)</code>
<code> [8]   r←⍬</code>
<code> [9]   recursionFlag←{(0&lt;⎕NC ⍵):⍎⍵ ⋄ 0}'recursionFlag'</code>
<code> [10]  (list1 list2)←{0::'' ⋄ ' '~¨⍨↓⍵.⎕NL 3 4 9.1 9.4 9.5}¨ref1 ref2</code>
<code> [11]  :If parms.ignoreTatin</code>
<code> [12]      (list1 list2)←{⍵~⊂'_tatin'}¨list1 list2</code>
<code> [13]      list1←RemoveRefsToTatin ref1 list1</code>
<code> [14]      list2←RemoveRefsToTatin ref2 list2</code>
<code> [15]  :EndIf</code>
<code> [16]  :If '['∊(⍕ref1),⍕ref2</code>
<code class="emphasize">→[17]      ⎕←'Cannot not compare ',(⍕ref1),'/',(⍕ref2) ⋄ :Return</code>
<code> [18]  :EndIf</code>
<code> [19]  list1←(ref1 __Get list1)/list1</code>
<code> [20]  list2←(ref2 __Get list2)/list2</code>
<code> [21]  data.report,←ProcessCode ref1 list1 list2 1    ⍝ Everything in [1] only</code>
<code> [22]  data.report,←ProcessCode ref2 list2 list1 2    ⍝ Everything in [2] only</code>
<code> [23]  data.report,←ScanCodeFoundInBothRefs(list1∩list2)ref1 ref2</code>
<code> [24]  :If 0=recursionFlag</code>
<code> [25]      (data.rubbish1 data.objects1),←ReportRubbishIn ref1 data.report1 data.objects1 recursionFlag parms.refsAreRubbish</code>
<code> [26]      (data.rubbish2 data.objects2),←ReportRubbishIn ref2 data.report2 data.objects2 recursionFlag parms.refsAreRubbish</code>
<code> [27]  :EndIf</code>
<code> [28]  (list1 list2)←{(0=≢⍵):'' ⋄ List ⍵}¨ref1 ref2</code>
<code> [29]  :If parms.ignoreTatin</code>
<code> [30]      (list1 list2)←{⍵~⊂'_tatin'}¨list1 list2</code>
<code> [31]      :If 0&lt;≢list1</code>
<code> [32]          list1←ref1{⍵/⍨((⍕⍺),'._tatin')∘≢¨⍕¨⍵}list1</code>
<code> [33]      :EndIf</code>
<code> [34]      :If 0&lt;≢list2</code>
<code> [35]          list2←ref2{⍵/⍨((⍕⍺),'._tatin')∘≢¨⍕¨⍵}list2</code>
<code> [36]      :EndIf</code>
<code> [37]  :EndIf</code>
<code> [38]  :If 1∨recursionFlag∧parms.refsAreRubbish ProcessUniqueObjects ref1 ref2 list1 list2 1 data parms</code>
<code> [39]      buff←ReportRubbishIn ref1 data.report1 data.objects1 1 parms.refsAreRubbish</code>
<code> [40]      (data.rubbish1 data.objects1)←(data.rubbish1 data.objects1),¨buff</code>
<code> [41]  :EndIf</code>
<code> [42]  :If 1∨recursionFlag∧parms.refsAreRubbish ProcessUniqueObjects ref2 ref1 list2 list1 2 data parms</code>
<code> [43]      buff←ReportRubbishIn ref2 data.report2 data.objects2 1 parms.refsAreRubbish</code>
<code> [44]      (data.rubbish2 data.objects2)←(data.rubbish2 data.objects2),¨buff</code>
<code> [45]  :EndIf</code>
<code> [46]  ScanOrdinaryNamespacesInBothRefs ref1 ref2 data parms</code>
</div>
<code class="header" id="listing_14">#.Compare.Compare.set_refToContainer1 &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_15">#.Compare.Compare.get_refToContainer1 &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_16">#.Compare.Compare.set_refToContainer2 &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_17">#.Compare.Compare.get_refToContainer2 &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_18">#.Compare.Compare.set_default data &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_19">#.Compare.Compare.get_default data &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_20">#.Compare.Compare.History &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  History</code>
<code> [1]   :Access Public Shared</code>
<code> [2]        ⍝ * 8.0.0 ⋄ 2025-03-28</code>
<code> [3]        ⍝   * Syntax change: `Version` returns now a character vector with the version number according to the package config file</code>
<code> [4]        ⍝   * `Get_UUID` removed as methoed</code>
<code> [5]        ⍝   * Packages updates</code>
<code> [6]        ⍝   * `Make` improved</code>
<code> [7]        ⍝ * 7.1.1</code>
<code> [8]        ⍝   * In case of no hits `Compare` might produce a NONCE ERROR</code>
<code> [9]        ⍝ * 7.1.0</code>
<code> [10]       ⍝   * Improved GUI</code>
<code> [11]       ⍝   * The "Find" now has a corresponding "Next" menu item, together with a "F3" short cut</code>
<code> [12]       ⍝   * Rubbish report was buggy</code>
<code> [13]       ⍝ * 7.0.0</code>
<code> [14]       ⍝   * BREAKING CHANGE: `Merge` returns always a two-item vector, and `readOnly←¯2`</code>
<code> [15]       ⍝     is not valid anymore though it is simply ignored when specified.</code>
<code> [16]       ⍝   * BREAKING CHANGE: `Merge` now requires a parameter space as optional left</code>
<code> [17]       ⍝     argument. Specifying one or two integers as `⍺` is now deprecated theough</code>
<code> [18]       ⍝     still supported for the time bing.</code>
<code> [19]       ⍝   * There is now a function `CreateMergeParms`</code>
<code> [20]       ⍝   * Can now ignore #._tatin / ⎕SE._tatin</code>
<code> [21]       ⍝   * Bug fixes</code>
<code> [22]       ⍝     `Merge` had a problem</code>
<code> [23]       ⍝\\</code>
<code> [24]       ⍝ For information regarding older versions see &lt;https://github.com/aplteam/Compare/releases&gt;</code>
</div>
<code class="header" id="listing_21">#.Compare.Compare.CreateMergeParms &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←CreateMergeParms</code>
<code> [1]  :Access Public Shared</code>
<code> [2]  r←⎕NS''</code>
<code> [3]  r.readOnly←0 0</code>
<code> [4]  r.refsAreRubbish←1</code>
<code> [5]  r.ignoreTatin←1</code>
<code> [6]  r.dropFromTitle←0</code>
</div>
<code class="header" id="listing_22">#.Compare.Compare.FormatTS &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code> r←FormatTS ts</code>
<code> [1]  r←{</code>
<code> [2]      0=≢⍵:''</code>
<code> [3]      0=+/⍵:''</code>
<code> [4]      ,'ZI4,&lt;-&gt;,ZI2,&lt;-&gt;,ZI2,&lt; &gt;,ZI2,&lt;:&gt;,ZI2,&lt;:&gt;,ZI2'⎕FMT,[0.5]6↑,⍵</code>
<code> [5]  }ts</code>
</div>
<code class="header" id="listing_23">#.Compare.Compare.ProcessUniqueObjects &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  {r}←refsAreRubbish ProcessUniqueObjects(ref1 ref2 list1 list2 ind data parms)</code>
<code> [1]      ⍝ Loop over all ordinary (non-scripted) namespaces that exist in `ref1` only</code>
<code> [2]   r←1</code>
<code> [3]   :If 0≠≢list1</code>
<code> [4]       :If 0=≢list2</code>
<code> [5]           list←list1</code>
<code> [6]       :Else</code>
<code> [7]           list←(~((1+⍴⍕ref1)↓¨⍕¨list1)∊((1+⍴⍕ref2)↓¨⍕¨list2))/list1</code>
<code> [8]       :EndIf</code>
<code> [9]   :AndIf 0≠≢list</code>
<code> [10]  :AndIf 0≠≢list←{(0=↑∘⍴∘Display.GetBody¨⍕¨⍵)/⍵}list</code>
<code> [11]      :For this :In list</code>
<code> [12]          r←0</code>
<code> [13]          1 ns_(ind⊃(this ⍬)(⍬ this)),data parms</code>
<code> [14]      :EndFor</code>
<code> [15]  :EndIf</code>
</div>
<code class="header" id="listing_24">#.Compare.Compare.ProcessCode &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←ProcessCode(ref list1 list2 no)</code>
<code> [1]      ⍝ Any stuff that is "code" (fns, opr, script)</code>
<code> [2]   r←''</code>
<code> [3]   :If 1∊bool←~list1∊list2</code>
<code> [4]       list←bool/list1</code>
<code> [5]       r←(+/bool)⍴⍕no       ⍝ indicator</code>
<code> [6]       r,¨←⊂¨bool/list1     ⍝ name1</code>
<code> [7]       r,¨←⊂⊂''             ⍝ path1</code>
<code> [8]       r,¨←⊂⊂''             ⍝ path2</code>
<code> [9]       ((2+no)⊃¨r)←⊂⍕ref    ⍝ The actual assignment</code>
<code> [10]      r,¨←GetNameClass∘{⍵[3 2]}¨r ⍝ type of 1</code>
<code> [11]      r,¨←GetNameClass∘{⍵[4 2]}¨r ⍝ type of 2</code>
<code> [12]      r,¨←⊂¨FormatTS¨{0::⍬ ⋄ 2 ⎕AT ⍵}¨{{⍺,'.',⍵}/⍵[3 2]}¨r ⍝ Last change of 1</code>
<code> [13]      r,¨←⊂¨FormatTS¨{0::⍬ ⋄ 2 ⎕AT ⍵}¨{{⍺,'.',⍵}/⍵[4 2]}¨r ⍝ Last change of 2</code>
<code> [14]      r,¨←⊂¨{0::'' ⋄ 4⊃⎕AT ⍵}¨{{⍺,'.',⍵}/⍵[3 2]}¨r ⍝ author of 1</code>
<code> [15]      r,¨←⊂¨{0::'' ⋄ 4⊃⎕AT ⍵}¨{{⍺,'.',⍵}/⍵[4 2]}¨r ⍝ author of 2</code>
<code> [16]  :EndIf</code>
</div>
<code class="header" id="listing_25">#.Compare.Compare.Differ &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  bool←a Differ b</code>
<code> [1]      ⍝ Ignore &lt;tab&gt; characters and blanks which are not enclosed by qoutes</code>
<code> [2]      ⍝ before doing the comparison</code>
<code> [3]   bool←1 ⍝ yes they differ</code>
<code> [4]   a←1↓⊃,/(⎕UCS 10),¨a</code>
<code> [5]   b←1↓⊃,/(⎕UCS 10),¨b</code>
<code> [6]   between←{⍺←'''' ⋄ {⍵∨≠\⍵}⍺=⍵}</code>
<code> [7]   b1←between a</code>
<code> [8]   b2←between b</code>
<code> [9]   :If (+/b1)=+/b2</code>
<code> [10]  :AndIf (b1/a)≡b2/b</code>
<code> [11]      a←(~b1)/a</code>
<code> [12]      b←(~b2)/b</code>
<code> [13]      a←a~' ',⎕UCS 9</code>
<code> [14]      b←b~' ',⎕UCS 9</code>
<code> [15]      bool←a≢b</code>
<code> [16]  :EndIf</code>
</div>
<code class="header" id="listing_26">#.Compare.Compare.ReportRubbishIn &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (rubbishReport rubbishObjects)←ReportRubbishIn(ref rubbishReport rubbishObjects recursionFlag refsAreRubbish)</code>
<code> [1]      ⍝ Reports :</code>
<code> [2]      ⍝ * Refs pointing to namespaces</code>
<code> [3]      ⍝ * Empty ordinary namespaces</code>
<code> [4]      ⍝ * Instances</code>
<code> [5]   rubbishObjects←rubbishReport←''</code>
<code> [6]   :If 0≠≢ref</code>
<code> [7]       (buf rubbishObjects)←InvestigateNamespaces(ref rubbishObjects''refsAreRubbish)</code>
<code> [8]       (buf rubbishObjects)←InvestigateInstances(ref rubbishObjects buf)</code>
<code> [9]       (buf rubbishObjects)←InvestigateClasses(ref rubbishObjects buf)</code>
<code> [10]      (buf rubbishObjects)←InvestigateInterfaces(ref rubbishObjects buf)</code>
<code> [11]      rubbishReport,←buf</code>
<code> [12]  :EndIf</code>
</div>
<code class="header" id="listing_27">#.Compare.Compare.InvestigateNamespaces &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (report rubbishObjects)←InvestigateNamespaces(ref rubbishObjects report refsAreRubbish)</code>
<code> [1]      ⍝ First we deal with references pointing to namespaces, unnamed or otherwise</code>
<code> [2]   :If 0≠≢list←ref.⎕NL-9.1                  ⍝ All namespaces</code>
<code> [3]       fn←(⊂(⍕ref),'.'),¨list               ⍝ Same but full name</code>
<code> [4]       bool←fn≢¨⍕¨GetDisplayFormat¨⍎¨fn     ⍝ 1=refs, 0=named namespaces</code>
<code> [5]       :If 0≠≢refs←bool/fn                  ⍝ Are there any pure refrences?</code>
<code> [6]           :If refsAreRubbish</code>
<code> [7]               report,←⊂'Namespace references:'refs</code>
<code> [8]               rubbishObjects,←refs</code>
<code> [9]           :EndIf</code>
<code> [10]      :EndIf</code>
<code> [11]      nn←(~bool)/fn                        ⍝ Named namespaces</code>
<code> [12]      :If 0≠≢nn                            ⍝ Any?</code>
<code> [13]      :AndIf 1∊bool2←{0=≢⍵.⎕NL⍳16}¨⍎¨nn    ⍝ Are they empty?</code>
<code> [14]          report,←⊂('Empty Namespaces:')(bool2/nn)</code>
<code> [15]          rubbishObjects,←bool2/nn</code>
<code> [16]      :EndIf</code>
<code> [17]  :EndIf</code>
</div>
<code class="header" id="listing_28">#.Compare.Compare.InvestigateClassesAndInterfaces &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  (report rubbishObjects)←InvestigateClassesAndInterfaces(ref rubbishObjects report nc)</code>
<code> [1]      ⍝ Now we deal with classes or interfaces: they may have code in their attached namespace</code>
<code> [2]      ⍝ "nc" is either 9.4 (classes) or 9.5 (interfaces)</code>
<code> [3]   :If 0≠≢list←ref.⎕NL-nc                   ⍝ Any at all?</code>
<code> [4]       fn←(⊂(⍕ref),'.'),¨list                ⍝ Full names</code>
<code> [5]   :AndIf 1∊bool←{0≠≢⍵.⎕NL⍳16}¨⍎¨fn         ⍝ Is the attached namespace not empty?!</code>
<code> [6]       msg←(9.4 9.5⍳nc)⊃'Classes' 'Interfaces'</code>
<code> [7]       msg,←' with code in attached namespace:'</code>
<code> [8]       report,←⊂(msg)(bool/fn)               ⍝ Indeed!</code>
<code> [9]   :EndIf</code>
</div>
<code class="header" id="listing_29">#.Compare.Compare.PolishRubbishReport &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block"><code>  r←PolishRubbishReport(ref1 ref2 data parms)</code>
<code> [1]        ⍝ Is a vector that contains all data for both, ref1 and ref2.</code>
<code> [2]        ⍝ The lines starting with "* " tell the starting points for ref1/ref2.</code>
<code> [3]        ⍝ Each has a vector of two-item-vector:</code>
<code> [4]        ⍝ [1] Is the type ("Ref", or "Instance" or "Empty"...)</code>
<code> [5]        ⍝ [2] Is the data found</code>
<code> [6]        ⍝ Each type can occur zero, once or many times. This function makes sure</code>
<code> [7]        ⍝ that they occure either zero or exactly one time</code>
<code> [8]   r←''</code>
<code> [9]   :For thisReport thisTitle :InEach (data.(rubbish1 rubbish2))(⍕¨ref1 ref2)</code>
<code> [10]      :If 0≠≢thisReport</code>
<code> [11]          r,←⊂parms.dropFromTitle↓thisTitle</code>
<code> [12]          buffer←0 2⍴''</code>
<code> [13]          :For type data :In thisReport</code>
<code> [14]              :If (⊂type)∊buffer[;1]</code>
<code> [15]                  ind←buffer[;1]⍳⊂type</code>
<code> [16]                  buffer[ind;2]←⊂∪(ind⊃buffer[;2]),parms.dropFromTitle↓¨data</code>
<code> [17]              :Else</code>
<code> [18]                  buffer⍪←type(parms.dropFromTitle↓¨data)</code>
<code> [19]              :EndIf</code>
<code> [20]          :EndFor</code>
<code> [21]          :If 0≠≢buffer</code>
<code> [22]              r,←↑,/{(⊂'  ',1⊃⍵),'     '∘,¨2⊃⍵}¨↓buffer</code>
<code> [23]          :EndIf</code>
<code> [24]      :EndIf</code>
<code> [25]  :EndFor</code>
</div>
<code class="header" id="listing_30">#.Compare.Compare.n &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_31">#.Compare.Compare.r &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_32">#.Compare.Compare.wait &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_33">#.Compare.Compare.caption &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<code class="header" id="listing_34">#.Compare.Compare.recursionFlag &mdash; 100%<a class="float-right no-print no-underline top-links" href="#top" title="Go to the top of the document">&#8607;</a><a  class="float-right no-print no-underline top-links" href="#partly-covered" title="Go to the beginning of 'Partly-covered'">↑</a></code>
<div class="code-block missing">Could not get canonical representation.</div>
<div id="footer">
<hr>
<p>Created by "CodeCoverage" version 0.10.7+52 from 2024-06-05</p>
</div>

</body>
</html>
